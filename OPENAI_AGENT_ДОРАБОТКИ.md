# –î–æ—Ä–∞–±–æ—Ç–∫–∏ OpenAI Agent

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

OpenAI Agent –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞, –±–∞–∑–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞. –¢–µ–ø–µ—Ä—å –∞–≥–µ–Ω—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –≤ —Ä–∞–º–∫–∞—Ö —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã.

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### ‚úÖ 1. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ç—É–ª–∑—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π

–ê–≥–µ–Ω—Ç —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:

- **file_create** - —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
- **file_edit** - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞  
- **folder_create** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏
- **plan_todo** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ –¥–µ–π—Å—Ç–≤–∏–π

**–í–∞–∂–Ω–æ:** –≠—Ç–∏ —Ç—É–ª–∑—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–∏–º—É–ª–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—É!

### ‚úÖ 2. –ü–∞—Ä–∞–º–µ—Ç—Ä kb_root_path

–ê–≥–µ–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—É—Ç—å –∫ –∫–æ—Ä–Ω—é –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:

```python
agent = OpenAIAgent(
    api_key="–∫–ª—é—á",
    base_url="url",
    model="qwen-max",
    kb_root_path=Path("./knowledge_base")  # –ü—É—Ç—å –∫ KB
)
```

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —ç—Ç–æ–≥–æ –ø—É—Ç–∏.

### ‚úÖ 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã KB

–ê–≥–µ–Ω—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:

1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑ –æ—Ç–≤–µ—Ç–∞ –∞–≥–µ–Ω—Ç–∞ (–±–ª–æ–∫ ```agent-result```)
2. –ó–∞—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—É—Ç–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. –í –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É

–ü—Ä–∏–º–µ—Ä:
```
–§–∞–π–ª: topics/ai/neural-networks/article.md
  ‚Üì
category: "ai"
subcategory: "neural-networks"
```

### ‚úÖ 4. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

–ê–≥–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π `AgentResult` —Å:
- `markdown` - –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- `title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫
- `kb_structure` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ KB (category, subcategory, tags)
- `metadata` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ñ–∞–π–ª–∞—Ö

### ‚úÖ 5. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞:
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ file_create –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –†–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ —Ç—É–ª–∑—ã, –∞ –Ω–µ –ø—Ä—è–º–æ–π –≤–æ–∑–≤—Ä–∞—Ç markdown
- –§–æ—Ä–º–∞—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ —Å –±–ª–æ–∫–æ–º ```agent-result```

### ‚úÖ 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π

- **Agent Factory** - –ø–µ—Ä–µ–¥–∞–µ—Ç kb_path –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–≥–µ–Ω—Ç–∞
- **Bot Handlers** - –ø–æ–ª—É—á–∞–µ—Ç –ø—É—Ç—å –∫ KB –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –∞–≥–µ–Ω—Ç—É
- –ö–µ—à –∞–≥–µ–Ω—Ç–æ–≤ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**
   - –ê–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç kb_root_path
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ç—É–ª–∑—ã

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
   - –ê–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
   - –°–æ–∑–¥–∞–µ—Ç –ø–ª–∞–Ω —á–µ—Ä–µ–∑ plan_todo
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é

3. **–†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏**
   - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫–∏ (folder_create)
   - –°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º (file_create)
   - –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

4. **–§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è**
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç KB —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç AgentResult

### –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

```python
# 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
message = "–°—Ç–∞—Ç—å—è –æ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö..."

# 2. Bot handler —Å–æ–∑–¥–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
agent = _get_or_create_user_agent(user_id)
# –ê–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç kb_path = "/path/to/user_kb"

# 3. –ê–≥–µ–Ω—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
result = await agent.process(content)

# 4. –ê–≥–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–∏–ª:
# - plan_todo(["Analyze", "Categorize", "Create file"])
# - folder_create(path="topics/ai")
# - file_create(path="topics/ai/neural-networks.md", content="...")

# 5. –ê–≥–µ–Ω—Ç –≤–µ—Ä–Ω—É–ª:
result = {
    "markdown": "# –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏\n\n...",
    "title": "–ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏",
    "kb_structure": KBStructure(category="ai", tags=["neural", "ml"]),
    "metadata": {
        "iterations": 3,
        "tools_used": ["plan_todo", "folder_create", "file_create"]
    }
}
```

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### src/agents/openai_agent.py
- –î–æ–±–∞–≤–ª–µ–Ω `kb_root_path` –ø–∞—Ä–∞–º–µ—Ç—Ä
- –ú–µ—Ç–æ–¥ `_register_kb_tools()` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç—É–ª–∑–æ–≤
- –ú–µ—Ç–æ–¥—ã `_handle_file_create()`, `_handle_file_edit()`, `_handle_folder_create()`
- –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω `_determine_kb_structure()` –¥–ª—è —É–º–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `_get_default_instruction()`

### src/agents/agent_factory.py
- –ú–µ—Ç–æ–¥ `_create_openai_agent()` –ø–µ—Ä–µ–¥–∞–µ—Ç `kb_root_path`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `kb_path` –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### src/bot/handlers.py
- –ú–µ—Ç–æ–¥ `_get_or_create_user_agent()` –ø–æ–ª—É—á–∞–µ—Ç kb_path –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–µ—Ä–µ–¥–∞–µ—Ç kb_path –≤ –∫–æ–Ω—Ñ–∏–≥ –∞–≥–µ–Ω—Ç–∞

### examples/autonomous_agent_example.py
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º kb_root_path
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ç—É–ª–∑–∞—Ö

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å** - –∞–≥–µ–Ω—Ç —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏
‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è  
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç AutonomousAgent –∏ BaseAgent
‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç AgentResult –∏ KBStructure
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –≤—Å–µ –ø—É—Ç–∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è, —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç—É–ª–∑—ã

## –ú–∏–≥—Ä–∞—Ü–∏—è

–°—Ç–∞—Ä—ã–π –∫–æ–¥:
```python
agent = OpenAIAgent(api_key="key")
agent.register_tool("file_create", my_handler)
```

–ù–æ–≤—ã–π –∫–æ–¥:
```python
agent = OpenAIAgent(
    api_key="key",
    kb_root_path=Path("./kb")
)
# file_create —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω!
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–æ–≤–µ—Ä–µ–Ω:
```bash
‚úì src/agents/openai_agent.py - OK
‚úì src/agents/agent_factory.py - OK  
‚úì src/bot/handlers.py - OK
```

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–º–µ—Ä–∞:
```bash
python examples/autonomous_agent_example.py
```

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å BaseAgent
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å AutonomousAgent
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π AgentResult
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π KB management
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å bot handlers
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## –ò—Ç–æ–≥

OpenAI Agent —Ç–µ–ø–µ—Ä—å:
1. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∞–≥–µ–Ω—Ç (–Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç AutonomousAgent)
2. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–≥–µ–Ω—Ç (—Å–ª–µ–¥—É–µ—Ç BaseAgent –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É)
3. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç AgentResult —Å kb_structure)
4. ‚úÖ –î–µ–ª–∞–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –≤ —Ä–∞–º–∫–∞—Ö —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã (—á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ç—É–ª–∑—ã)

–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã! üéâ
