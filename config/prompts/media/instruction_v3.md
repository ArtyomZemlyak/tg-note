## Работа с медиафайлами (алгоритм)

### КРИТИЧНО
- **Обработай КАЖДЫЙ файл**. Никаких пропусков.
- **Используй относительные пути** (`media/`, `../media/`, `../../media/`).
- **Не дублируй** вставки в одном файле.
- Предварительно выполни остальные шаги заполнения базы знаний. Медиа вставлять уже нужно после того как все сгенерировано.

### Алгоритм

1. **Подсчитай объём работы.**
   - `N_media_type` = файлов медиа (видео, аудио, pdf, images).

2. **Обработай медиафайлы итеративно.**
   - Файл: `media/media_type_XXXX_slug.jpg`
   - Метаданные: `media/media_type_XXXX_slug.md`
   - Шаги:
     1. Прочитай `.md` (OCR + заметки).
     2. Проанализируй в какое место сгенерированных и отредактированных документов нужно вставить медиа. Очень важно вставлять медиа в разные но соответствующие места документов.
     3. Вставь медиа с правильным путём:
        - корень: `media/...`
        - `topics/`: `../media/...`
        - `topics/sub/...`: `../../media/...`
     4. Добавь описание дважды: alt-text + текст под медиа.

3. **Обработай остальные типы медиа.**
   - Видео (`vid_*.mp4`), аудио (`aud_*.mp3`), PDF и т.д.
   - Используй Markdown-ссылку + пояснение
   - Для аудио перечисли тезисы. Для PDF перечисли ключевые разделы/метрики.

4. **Финальная проверка.**
   - В каждом файле найден из списка должен быть ровно один путь (картинка или ссылка).
   - Подсчитай `![` с путями к `media/media_type_*.jpg` → количество = `N_media_type`.

### Шпаргалка по путям

| Где редактируешь файл | Относительный путь |
|-----------------------|--------------------|
| Корень KB             | `media/...`        |
| `topics/`             | `../media/...`     |
| `topics/sub/...`      | `../../media/...`  |


### Контрольный список
1. Предварительно все нужные документы сгенерированы и отредактированы
2. Все пути указывают на `media/`.
3. Вставлено столько media, сколько `media_type_*.jpg` в сообщении пользователя.
4. В тексте есть пояснения ко всем ссылкам на видео/аудио/PDF/image.
5. Все `.md` из `media/` для медиа из сообщения пользователя прочитаны и информация учтена.
